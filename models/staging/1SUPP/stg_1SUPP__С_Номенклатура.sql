with 
source as 
(SELECT * FROM {{ source('Stage1CUpp', 'С_Номенклатура') }}),

filtred as 
(
	select * from source
	where "ЭтоГруппа" = False
),

renamed_and_cast as 
(
	select
	"Артикул",
	"БазоваяЕдиницаИзмерения" as "Единица Измерения номенклат.",
	--"Весовой",
	--"ВесовойКоэффициентВхождения",
	--"ВестиОперативныйУчетОстатковНЗП",
	--"ВестиПартионныйУчетПоСериям",
	--"ВестиУчетПоСериям",
	--"ВестиУчетПоСериямВНЗП",
	--"ВестиУчетПоХарактеристикам",
	--"ВидВоспроизводства",
	"ВидНоменклатуры" as "Вид номенклат.",
	--"ЕдиницаДляОтчетов",
	"ЕдиницаХраненияОстатков" as "Единица остатков номенклат.",
	--"Комментарий",
	--"Набор",
	--"НазначениеИспользования",
	"НаименованиеПолное" as "Полное наименование номенклат.",
	"НоменклатурнаяГруппа" as "Номенклатурная группа",
	--"НоменклатурнаяГруппаЗатрат",
	--"НомерГТД",
	--"ОсновноеИзображение",
	"ОсновнойПоставщик" as "Основной поставщик номенклат.",
	--"ОтветственныйМенеджерЗаПокупки",
	"СтавкаНДС" as "Ставка НДС номенклат.",
	--"СтатьяЗатрат",
	--"СтранаПроисхождения",
	--"ТребуетсяВнешняяСертификация",
	--"ТребуетсяВнутренняяСертификация",
	--"Услуга",
	--"ВестиСерийныеНомера",
	--"Комплект",
	--"НаправлениеВыпуска",
	--"ЦеноваяГруппа",
	--"ОКП",
	--"ЕдиницаИзмеренияМест",
	--"Сертификат",
	--"УдостоверениеГГР",
	"СрокГодности" as "Срок годности номенклат.",
	--"ВидУпаковки",
	--"СоответствиеТНПА",
	"КоличествоВУпаковке" as "Количество в упаковке номенклат.",
	"КоличествоНаПаллете" as "Количество на паллете номенклат.",
	"юи_ВысотаНоменклатуры" as "Высота номенклат.",
	--"АртикулСтараяКрепость",
	--"СрокГодностиМесяцев",
	"юи_мВидПаллетыРазмещения" as "Вид паллеты размещения номенклат.",
	--"юи_мРасчитыватьСрокПоДням",
	"юи_мВыдержкаДней" as "Выдержка дней номенклат.",
	--"юи_БриксМин",
	--"юи_БриксМакс",
	--"юи_КислотностьМин",
	--"юи_КислотностьМакс",
	--"юи_Плотность",
	--"юи_ТочностьОкругления",
	--"юи_ОсновнаяПартияРозлива",
	--"юи_УчитыватьПотери",
	--"юи_Код77",
	--"юи_Андроид",
	--"юи_КодТНВЭД",
	--"ДекларацияТРТС",
	--"юи_НоменклатурнаяСубгруппа",
	--"юи_ВидТары",
	--"юи_ШтукВЕдТары",
	--"юи_НоменклатурнаяГруппаОПС",
	--"ВидОборудования",
	--"юи_ГруппаДляТТН",
	--"ВесЕдиницы" as "Вес единицы номенклат.",
	"Статус" as "Статус номенклат.",
	--"Предопределенный",
	--"Ссылка",
	--"ПометкаУдаления",
	--"ЭтоГруппа",
	--"Родитель",
	"Наименование" as "Наименование номенклат.",
	--"Код",
	--"ПараметрНаименование",
	--"БазоваяЕдиницаИзмеренияГуид",
	--"ВидНоменклатурыГуид",
	--"ЕдиницаДляОтчетовГуид",
	--"ЕдиницаХраненияОстатковГуид",
	--"НазначениеИспользованияГуид",
	--"НоменклатурнаяГруппаГуид",
	--"НоменклатурнаяГруппаЗатратГуид",
	--"НомерГТДГуид",
	--"ОсновноеИзображениеГуид",
	--"ОсновнойПоставщикГуид",
	--"СтатьяЗатратГуид",
	--"СтранаПроисхожденияГуид",
	--"ЦеноваяГруппаГуид",
	--"ОКПГуид",
	--"ЕдиницаИзмеренияМестГуид",
	--"СертификатГуид",
	--"УдостоверениеГГРГуид",
	--"ВидУпаковкиГуид",
	--"СоответствиеТНПАГуид",
	--"юи_КодТНВЭДГуид",
	--"ДекларацияТРТСГуид",
	--"юи_НоменклатурнаяСубгруппаГуид",
	--"юи_ВидТарыГуид",
	--"юи_НоменклатурнаяГруппаОПСГуид",
	--"юи_ГруппаДляТТНГуид",
	--"СтатусГуид",
	"СсылкаГуид"::text
	--"РодительГуид",
	--"__Partition"
	from filtred
)

select * from renamed_and_cast